
from ctgan import CTGAN
from ctgan import load_demo
import os
import pandas as pd

# Get the path for this current file 
curr_path = os.path.abspath(__file__)
# Get the root path by deleting everything after the specified folder 
curr_abs_path = curr_path.split('SyntheticFraud')[0]

df = pd.read_csv(curr_abs_path + 'SyntheticFraud/OutputData/data_with_classified_scam.csv', index_col=0)
df['Descriptions'] = df['Descriptions'].apply(lambda x: x.replace(' ', '-'))
df['Category'] = df['Category'].apply(lambda x: x.replace(' ', '-'))

#%% Feature engineering 






#%% The GAN 
col_names = df.columns                      # names of columns
col_vals = df.apply(lambda x: x.dropna().nunique())  # get factor levels (e.g. 0,1)
factor_columns = col_names[col_vals == 2] #only columns that have two levels 


# Names of the columns that are discrete
discrete_columns = factor_columns

ctgan = CTGAN(epochs=10)
ctgan.fit(df, discrete_columns)

# Create synthetic data
synthetic_data = ctgan.sample(100)